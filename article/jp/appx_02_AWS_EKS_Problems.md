# はじめに
自分のアカウントで EKS を使用したところ10日間の使用で $190 USD かかりました。
今回の記事では、 EKS を使用する時にかかる費用費用のポイントを説明したいと思います。
# この記事で実施する内容
1, EKS で掛かった金額
2, EKS がなぜ高いのか？
# 1, EKS で掛かった金額
今回はテスト環境を構築するために個人アカウントで EKS を使用しています。使用を開始したのは今年1月4日。
週末にいろいろな作業を行い、月曜日に Billing and Cost Management を確認したところ Total forecasted cost for current month は $50 を表示しており、 「まあ、そうだろうな」と思っていました。
しかし、そのまま稼働させたままの10日後、嫌な予感がしたので再度確認をしたのです。すると Month-to-date cost はすでに $190 、月末までの予測は $2500になっていました。
すぐに関連するサービスを停止・削除したものの、今月の支払いは前月比 +2800%。経済が崩壊した国のインフレ率のようです。
# 2, EKS がなぜ高いのか？
EKS そのものが高い -- $0.10 / 時間 -- ということもありますが、EKS 単体ではやりたいことができない、AWS の様々なサービスを組み合わせないと結局意味がないことが大きな理由です。
アプリケーション障害を避けるため、あるいはマイクロサービスの設定を楽にするために Kubernetes がありますが、逆に EKS を動かすためには何が必要かを考えると以下のような AWS サービスを使う必要があります。
- EKS が管理する EC2 インスタンス
- ネットワーク構成
  - VPC
  - Load balancer
  - Subnet
  - Route table 
  - Security group
  - Access control list
  - NAT Gateway
  - Elastic IP
- EKS
- Kubernetes が使用するイメージを格納する ECR
- RDS
もちろん無料のサービスもありますし、EC2 / RDS はサイズとコストを調整することができます、しかし現実の使用に耐える構成にする場合、安くはできないでしょう。
また、NAT Gateway のような、その機能そのもののコストは $0.045 / 時間ですが、処理データ1GBあたりの料金が別に必要なサービスもあります。

通りで予算に余裕のある大きな企業さんしか EKS を使わず、まずは ECS で冗長性を持たせるお客さんがおおいはずです。
高い勉強代でした。
